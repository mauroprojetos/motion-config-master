###
### dogshedmiddle sensors
###

###
# found
###

- platform: mqtt
  name: motion_status_camera_found_dogshedmiddle
  state_topic: 'motion/+/dogshedmiddle/status/found'
  expire_after: 86400
  force_update: true
  json_attributes:
    - device
    - camera
    - date
    - status
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}

## dates
- platform: template
  sensors:
    motion_status_camera_found_date_dogshedmiddle:
      entity_id:
        - sensor.motion_status_camera_found_dogshedmiddle
      unit_of_measurement: seconds
      value_template: >-
        {% if state_attr('sensor.motion_status_camera_found_dogshedmiddle','date')|lower != 'none'
              and states.sensor.motion_status_camera_found_dogshedmiddle.attributes.date|int > 0 %}
          {{ states.sensor.motion_status_camera_found_dogshedmiddle.attributes.date|int }}
        {% else %}{{ now().timestamp()|int }}{% endif %}

- platform: template
  sensors:
    motion_status_camera_found_when_dogshedmiddle:
      friendly_name: dogshedmiddle found
      entity_id:
        - sensor.motion_status_camera_found_date_dogshedmiddle
      value_template: >-
        {% if states.sensor.motion_status_camera_found_date_dogshedmiddle|lower != 'none'
              and states.sensor.motion_status_camera_found_date_dogshedmiddle.state|int > 0 %}
          {{ states.sensor.motion_status_camera_found_date_dogshedmiddle.state|int|timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %}null{% endif %} 

###
# lost
###

- platform: mqtt
  name: motion_status_camera_lost_dogshedmiddle
  state_topic: 'motion/+/dogshedmiddle/status/lost'
  expire_after: 86400
  force_update: true
  json_attributes:
    - device
    - camera
    - date
    - status
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}

## dates
- platform: template
  sensors:
    motion_status_camera_lost_date_dogshedmiddle:
      entity_id:
        - sensor.motion_status_camera_lost_dogshedmiddle
      unit_of_measurement: seconds
      value_template: >-
        {% if state_attr('sensor.motion_status_camera_lost_dogshedmiddle','date')|lower != 'none'
              and states.sensor.motion_status_camera_lost_dogshedmiddle.attributes.date|int > 0 %}
          {{ states.sensor.motion_status_camera_lost_dogshedmiddle.attributes.date|int }}
        {% else %}{{ now().timestamp()|int }}{% endif %}

- platform: template
  sensors:
    motion_status_camera_lost_when_dogshedmiddle:
      friendly_name: dogshedmiddle lost
      entity_id:
        - sensor.motion_status_camera_lost_date_dogshedmiddle
      value_template: >-
        {% if states.sensor.motion_status_camera_lost_date_dogshedmiddle|lower != 'none'
              and states.sensor.motion_status_camera_lost_date_dogshedmiddle.state|int > 0 %}
          {{ states.sensor.motion_status_camera_lost_date_dogshedmiddle.state|int|timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %}null{% endif %} 

###
# start event
###

- platform: mqtt
  name: motion_event_start_dogshedmiddle
  qos: 1
  state_topic: 'motion/+/dogshedmiddle/event/start'
  expire_after: 30
  force_update: true
  json_attributes:
    - device
    - camera
    - event
    - start
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}

###
# image event
###

- platform: mqtt
  name: motion_event_image_dogshedmiddle
  qos: 1
  state_topic: 'motion/+/dogshedmiddle/event/image'
  expire_after: 1
  force_update: true
  json_attributes:
    - device
    - camera
    - type
    - date
    - seqno
    - event
    - id
    - center
    - width
    - height
    - size
    - noise
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}

###
# end event
###

- platform: mqtt
  name: motion_event_end_dogshedmiddle
  qos: 2
  state_topic: 'motion/+/dogshedmiddle/event/end'
  expire_after: 60
  force_update: True
  json_attributes:
    - device
    - camera
    - event
    - start
    - end
    - elapsed
    - date
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}

## status
- platform: template
  sensors:
    motion_end_status_dogshedmiddle:
      friendly_name: dogshedmiddle motion
      entity_id:
        - sensor.motion_end_counter_dogshedmiddle
        - sensor.motion_end_ago_dogshedmiddle
      value_template: >-
        {% set elapsed = states('sensor.motion_end_elapsed_dogshedmiddle')|int %}
        {% set ago = states('sensor.motion_end_ago_dogshedmiddle')|int %}
        {% if elapsed > 0 %} {{ elapsed }} {% else %} zero {% endif %} second(s);
        {{ ago }} second(s) ago

## counting
- platform: template
  sensors:
    motion_end_counter_dogshedmiddle:
      friendly_name: dogshedmiddle end counter
      entity_id:
        - counter.motion_end_counter_dogshedmiddle
      unit_of_measurement: count
      value_template: >-
        {% if states.counter.motion_end_counter_dogshedmiddle|lower != 'none' %}
          {{ states.counter.motion_end_counter_dogshedmiddle.state|int }}
        {%- else -%}null{%- endif -%}

## timing
- platform: template
  sensors:
    motion_end_date_dogshedmiddle:
      entity_id:
        - sensor.motion_end_counter_dogshedmiddle
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_event_end_dogshedmiddle|lower != 'none' and state_attr('sensor.motion_event_end_dogshedmiddle','end')|lower != 'none' %}
          {% set date = states.sensor.motion_event_end_dogshedmiddle.attributes.end|int %}
          {% if date > 0 %}{{ date }}{% else %}null{% endif %}
        {% else %}null{% endif %}

- platform: template
  sensors:
    motion_end_when_dogshedmiddle:
      friendly_name: dogshedmiddle end
      entity_id:
        - sensor.motion_end_date_dogshedmiddle
      value_template: >-
        {% set date = states('sensor.motion_end_date_dogshedmiddle')|int %}
        {% if date > 0 %} {{ date|timestamp_custom("%a %b %d ~ %I:%M %p") }} {% else %}never{% endif %}

- platform: template
  sensors:
    motion_end_ago_dogshedmiddle:
      friendly_name: dogshedmiddle end ago
      entity_id:
        - sensor.motion_end_date_dogshedmiddle
        - sensor.time
      unit_of_measurement: seconds
      value_template: >
        {% set s = states('sensor.motion_end_date_dogshedmiddle')|int %}
        {% if s >  0 %}
          {% set s = now().timestamp()|int - s %}
          {% if s <  86400 %}{{ s }}{%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}

## elapsed
- platform: template
  sensors:
    motion_end_elapsed_dogshedmiddle:
      entity_id:
        - sensor.motion_end_counter_dogshedmiddle
      value_template: >
        {% if states.sensor.motion_event_end_dogshedmiddle|lower != 'none'
              and state_attr('sensor.motion_event_end_dogshedmiddle','elapsed')|lower != 'none' %}
          {{ states.sensor.motion_event_end_dogshedmiddle.attributes.elapsed }}
        {% else %} null {% endif %}

###
## annotated
###

## event_annotated
- platform: mqtt
  name: motion_event_annotated_dogshedmiddle
  state_topic: 'motion/+/dogshedmiddle/event/end/+'
  expire_after: 60
  force_update: true
  json_attributes:
    - timestamp
    - date
    - time
    - count
    - event
    - info
    - detected
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}

## status
- platform: template
  sensors:
    motion_annotated_status_dogshedmiddle:
      friendly_name: dogshedmiddle annotated
      entity_id:
        - sensor.motion_annotated_counter_dogshedmiddle
        - sensor.motion_annotated_ago_dogshedmiddle
      value_template: >-
        {% set count = states('sensor.motion_annotated_count_dogshedmiddle')|int %}
        {% set saw = states('sensor.motion_annotated_list_dogshedmiddle') %}
        {% set ago = states('sensor.motion_annotated_ago_dogshedmiddle')|int %}
        {% set delay = states('sensor.motion_annotated_delay_dogshedmiddle')|int %}
        {% set when = states('sensor.motion_annotated_when_dogshedmiddle') %}
        {% if count > 0 %}{{ count }} entity(s): {{ saw -}};{% else %}nothing;{% endif %}
        {{ when }}; delay: {{ delay }}; {{ ago }} second(s) ago

## count
- platform: template
  sensors:
    motion_annotated_count_dogshedmiddle:
      friendly_name: dogshedmiddle annotated count
      entity_id:
        - counter.motion_annotated_counter_dogshedmiddle
      unit_of_measurement: entities
      value_template: >
        {% if state_attr('sensor.motion_event_annotated_dogshedmiddle','count') is not none %}
          {{ state_attr('sensor.motion_event_annotated_dogshedmiddle','count')|int }}
        {% else %}null{% endif %}

## entity_count_loop
- platform: template
  sensors:
    motion_annotated_entity_count_loop_dogshedmiddle:
      entity_id:
        - sensor.motion_annotated_count_dogshedmiddle
      unit_of_measurement: entities
      value_template: >-
        {% set camera = 'dogshedmiddle' %}
        {% set count = states('sensor.motion_annotated_count_' + camera)|int %}
        {% if count > 0 %}
          {% set s = states('sensor.motion_detect_entity') %}
          {% for detected in state_attr('sensor.motion_event_annotated_' + camera,'detected') %}
            {% if detected.entity == s or s == 'all' %}
              {{ detected.count|int }}
            {% endif %}
          {% endfor %}
        {% else %}null{% endif %}

## entity_count
- platform: template
  sensors:
    motion_annotated_entity_count_dogshedmiddle:
      friendly_name: dogshedmiddle annotated entity count
      entity_id:
        - sensor.motion_annotated_entity_count_loop_dogshedmiddle
      unit_of_measurement: entities
      value_template: >-
        {{ states('sensor.motion_annotated_entity_count_loop_dogshedmiddle')|int }}

## annotated_list
- platform: template
  sensors:
    motion_annotated_list_dogshedmiddle:
      friendly_name: dogshedmiddle annotated entity list
      entity_id:
        - counter.motion_annotated_counter_dogshedmiddle
      value_template: >-
        {% set camera = 'dogshedmiddle' %}
        {% set count = state_attr('sensor.motion_event_annotated_' + camera,'count') %}
        {% set array = state_attr('sensor.motion_event_annotated_' + camera,'detected') %}
        {% if count > 0 and array is not none %}
          {% for detected in array %}
            {%- if loop.first -%}{%- else -%},{%- endif -%}
            {{- detected.entity -}}
          {% endfor %}
        {% else %}null{% endif %}

## counter
- platform: template
  sensors:
    motion_annotated_counter_dogshedmiddle:
      friendly_name: dogshedmiddle annotated counter
      entity_id:
        - sensor.motion_annotated_entity_count_dogshedmiddle
      unit_of_measurement: count
      value_template: >
        {% if states('counter.motion_annotated_counter_dogshedmiddle') != 'unknown' %}
          {{ states('counter.motion_annotated_counter_dogshedmiddle')|int }}
        {%- else -%}null{%- endif -%}

## date
- platform: template
  sensors:
    # date
    motion_annotated_date_dogshedmiddle:
      entity_id:
        - sensor.motion_annotated_count_dogshedmiddle
      unit_of_measurement: seconds
      value_template: >-
        {% if  state_attr('sensor.motion_event_annotated_dogshedmiddle','event') is not none %}
          {% set date = states.sensor.motion_event_annotated_dogshedmiddle.attributes.event.end|int %}
          {% if date > 0 %}{{ date }}{% else %}null{% endif %}
        {% else %}null{% endif %}

## when
- platform: template
  sensors:
    motion_annotated_when_dogshedmiddle:
      friendly_name: dogshedmiddle annotated
      entity_id:
        - sensor.motion_annotated_date_dogshedmiddle
      value_template: >-
        {% set date = states('sensor.motion_annotated_date_dogshedmiddle')|int %}
        {% if date > 0 %} {{ date|timestamp_custom("%a %b %d ~ %I:%M %p") }} {% else %}never{% endif %}

## ago
- platform: template
  sensors:
    motion_annotated_ago_dogshedmiddle:
      friendly_name: dogshedmiddle annotated ago
      entity_id:
        - sensor.motion_annotated_date_dogshedmiddle
        - sensor.time
      unit_of_measurement: seconds
      value_template: >
        {% set s = states('sensor.motion_annotated_date_dogshedmiddle')|int %}
        {% if s >  0 %}
          {% set s = now().timestamp()|int - s %}
          {% if s <  86400 %}{{ s }}{%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}

## percent
- platform: template
  sensors:
    motion_annotated_percent_dogshedmiddle:
      friendly_name: dogshedmiddle annotated percent
      entity_id:
        - sensor.motion_end_counter_dogshedmiddle
        - sensor.motion_annotated_counter_dogshedmiddle
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_annotated_counter_dogshedmiddle')|int > 0 and states('sensor.motion_end_counter_dogshedmiddle')|int > 0 %}
          {{  ( states.sensor.motion_annotated_counter_dogshedmiddle.state|int / states.sensor.motion_end_counter_dogshedmiddle.state|int ) * 100.0 }}
        {%- else -%}null{%- endif -%}

## delay 
- platform: template
  sensors:
    motion_annotated_delay_dogshedmiddle:
      friendly_name: dogshedmiddle delay 
      entity_id:
        - sensor.motion_annotated_date_dogshedmiddle
      unit_of_measurement: seconds
      value_template: >
        {{ now().timestamp()|int - states('sensor.motion_annotated_date_dogshedmiddle')|int }}

###
# statistics
###

## ago
- platform: template
  sensors:
    motion_annotated_ago_dogshedmiddle_mean:
      friendly_name: dogshedmiddle annotated ago avg
      entity_id:
        - sensor.motion_annotated_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_annotated_ago_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle annotated min
      entity_id:
        - sensor.motion_annotated_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_annotated_ago_dogshedmiddle_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle annotated max
      entity_id:
        - sensor.motion_annotated_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_annotated_ago_dogshedmiddle_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle annotated stdev
      entity_id:
        - sensor.motion_annotated_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_annotated_ago_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_dogshedmiddle_change:
      friendly_name: dogshedmiddle annotated change
      entity_id:
        - sensor.motion_annotated_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_annotated_ago_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## percent
- platform: template
  sensors:
    motion_annotated_percent_dogshedmiddle_mean:
      friendly_name: dogshedmiddle annotated percent avg
      entity_id:
        - sensor.motion_annotated_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_annotated_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_percent_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle annotated percent min
      entity_id:
        - sensor.motion_annotated_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_annotated_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_percent_dogshedmiddle_statistics.attributes.min_value|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle annotated percent max
      entity_id:
        - sensor.motion_annotated_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_annotated_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_percent_dogshedmiddle_statistics.attributes.max_value|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle annotated percent stdev
      entity_id:
        - sensor.motion_annotated_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_annotated_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_percent_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_dogshedmiddle_change:
      friendly_name: dogshedmiddle annotated percent change
      entity_id:
        - sensor.motion_annotated_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_annotated_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_percent_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## delay 
- platform: template
  sensors:
    motion_annotated_delay_dogshedmiddle_mean:
      friendly_name: dogshedmiddle delay avg
      entity_id:
        - sensor.motion_annotated_delay_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states('sensor.motion_annotated_delay_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_delay_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle delay min
      entity_id:
        - sensor.motion_annotated_delay_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states('sensor.motion_annotated_delay_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_delay_dogshedmiddle_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle delay max
      entity_id:
        - sensor.motion_annotated_delay_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states('sensor.motion_annotated_delay_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_delay_dogshedmiddle_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle delay stdev
      entity_id:
        - sensor.motion_annotated_delay_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states('sensor.motion_annotated_delay_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_delay_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_dogshedmiddle_change:
      friendly_name: dogshedmiddle delay change
      entity_id:
        - sensor.motion_annotated_delay_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states('sensor.motion_annotated_delay_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_annotated_delay_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## statistics

# ago
- platform: statistics
  name: motion_annotated_ago_dogshedmiddle_statistics
  entity_id: sensor.motion_annotated_ago_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_annotated_ago_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_annotated_ago_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

# percent
- platform: statistics
  name: motion_annotated_percent_dogshedmiddle_statistics
  entity_id: sensor.motion_annotated_percent_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_annotated_percent_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_annotated_percent_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

# delay
- platform: statistics
  name: motion_annotated_delay_dogshedmiddle_statistics
  entity_id: sensor.motion_annotated_delay_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_annotated_delay_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_annotated_delay_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

###
## detected
###

## status
- platform: template
  sensors:
    motion_detected_status_dogshedmiddle:
      friendly_name: dogshedmiddle Seen
      entity_id:
        - sensor.motion_detected_when_dogshedmiddle
      value_template: >-
        {% set when = states('sensor.motion_detected_when_dogshedmiddle') %}
        {% set count = states('sensor.motion_detected_count_dogshedmiddle')|int %}
        {% set what = states('sensor.motion_detected_list_dogshedmiddle') %}
        {{ count }} entities: {{ what -}}; {{ when }}

## count
- platform: template
  sensors:
    # count
    motion_detected_count_dogshedmiddle:
      friendly_name: dogshedmiddle detected count
      entity_id:
        - binary_sensor.motion_detected_dogshedmiddle
      unit_of_measurement: entities
      value_template: >-
        {{ states('sensor.motion_annotated_count_dogshedmiddle')|int }}

## counter
- platform: template
  sensors:
    motion_detected_counter_dogshedmiddle:
      friendly_name: dogshedmiddle detected counter
      entity_id:
        - sensor.motion_detected_count_dogshedmiddle
      unit_of_measurement: count
      value_template: >
        {% if states('counter.motion_detected_counter_dogshedmiddle') != 'unknown' %}
          {{ states('counter.motion_detected_counter_dogshedmiddle')|int }}
        {%- else -%}null{%- endif -%}

## date
- platform: template
  sensors:
    motion_detected_date_dogshedmiddle:
      friendly_name: dogshedmiddle detected date
      entity_id:
        - sensor.motion_detected_counter_dogshedmiddle
      unit_of_measurement: seconds
      value_template: >-
        {% set date = states('sensor.motion_annotated_date_dogshedmiddle')|int %}
        {% if date > 0 %}{{ date }}{% else %}null{% endif %}

## when
- platform: template
  sensors:
    motion_detected_when_dogshedmiddle:
      friendly_name: dogshedmiddle detected at
      entity_id:
        - sensor.motion_detected_date_dogshedmiddle
      value_template: >-
        {% set date = states('sensor.motion_detected_date_dogshedmiddle')|int %}
        {% if date > 0 %} {{ date|timestamp_custom("%a %b %d ~ %I:%M %p") }} {% else %}never{% endif %}

## ago
- platform: template
  sensors:
    motion_detected_ago_dogshedmiddle:
      friendly_name: dogshedmiddle seen ago
      entity_id:
        - sensor.motion_detected_date_dogshedmiddle
        - sensor.time
      unit_of_measurement: seconds
      value_template: >
        {% set s = states('sensor.motion_detected_date_dogshedmiddle')|int %}
        {% if s >  0 %}
          {% set s = now().timestamp()|int - s %}
          {% if s <  86400 %}{{ s }}{%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}

## list
- platform: template
  sensors:
    motion_detected_list_dogshedmiddle:
      friendly_name: dogshedmiddle entity list
      entity_id:
        - sensor.motion_detected_count_dogshedmiddle
      value_template: >-
        {{ states('sensor.motion_annotated_list_dogshedmiddle') }}

## percent
- platform: template
  sensors:
    motion_detected_percent_dogshedmiddle:
      friendly_name: dogshedmiddle seen
      entity_id:
        - sensor.motion_annotated_counter_dogshedmiddle
        - sensor.motion_detected_counter_dogshedmiddle
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_counter_dogshedmiddle')|int > 0 and states('sensor.motion_annotated_counter_dogshedmiddle')|int > 0 %}
          {{  ( states.sensor.motion_detected_counter_dogshedmiddle.state|int / states.sensor.motion_annotated_counter_dogshedmiddle.state|int ) * 100.0 }}
        {%- else -%}null{%- endif -%}

###
## statistics
###

## ago
- platform: template
  sensors:
    motion_detected_ago_dogshedmiddle_mean:
      friendly_name: dogshedmiddle seen ago avg
      entity_id:
        - sensor.motion_detected_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_ago_dogshedmiddle_statistics|lower != 'none' %}
          {% if states.sensor.motion_detected_ago_dogshedmiddle_statistics.state|int is number %}
            {{ states.sensor.motion_detected_ago_dogshedmiddle_statistics.state|float }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle seen ago min
      entity_id:
        - sensor.motion_detected_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_ago_dogshedmiddle_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle seen ago max
      entity_id:
        - sensor.motion_detected_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_ago_dogshedmiddle_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle seen ago stdev
      entity_id:
        - sensor.motion_detected_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_ago_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_dogshedmiddle_change:
      friendly_name: dogshedmiddle ago change
      entity_id:
        - sensor.motion_detected_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_ago_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## count
- platform: template
  sensors:
    motion_detected_count_mean_dogshedmiddle:
      friendly_name: dogshedmiddle seen avg
      entity_id:
        - sensor.motion_detected_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states('sensor.motion_detected_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_count_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle seen min
      entity_id:
        - sensor.motion_detected_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states('sensor.motion_detected_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_count_dogshedmiddle_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle seen max
      entity_id:
        - sensor.motion_detected_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states('sensor.motion_detected_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_count_dogshedmiddle_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle seen stdev
      entity_id:
        - sensor.motion_detected_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states('sensor.motion_detected_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_count_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_dogshedmiddle_change:
      friendly_name: dogshedmiddle seen change
      entity_id:
        - sensor.motion_detected_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states('sensor.motion_detected_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_count_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## percent
- platform: template
  sensors:
    motion_detected_percent_dogshedmiddle_mean:
      friendly_name: dogshedmiddle seen avg
      entity_id:
        - sensor.motion_detected_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_percent_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle seen min
      entity_id:
        - sensor.motion_detected_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_percent_dogshedmiddle_statistics.attributes.min_value|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle seen max
      entity_id:
        - sensor.motion_detected_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_percent_dogshedmiddle_statistics.attributes.max_value|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle seen stdev
      entity_id:
        - sensor.motion_detected_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_detected_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_percent_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_dogshedmiddle_change:
      friendly_name: dogshedmiddle seen change
      entity_id:
        - sensor.motion_detected_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_detected_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_percent_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## statistics

# ago
- platform: statistics
  name: motion_detected_ago_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_ago_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_ago_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_ago_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

# count
- platform: statistics
  name: motion_detected_count_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_count_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_count_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_count_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

# percent
- platform: statistics
  name: motion_detected_percent_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_percent_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_percent_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_percent_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

###
## detected_entity
###

## status
- platform: template
  sensors:
    motion_detected_entity_status_dogshedmiddle:
      friendly_name: dogshedmiddle found
      entity_id:
        - sensor.motion_detected_entity_when_dogshedmiddle
      value_template: >-
        {% set count = states('sensor.motion_detected_entity_count_dogshedmiddle')|int %}
        {% set what = states('sensor.motion_detect_entity') %}
        {% set when = states('sensor.motion_detected_entity_when_dogshedmiddle') %}
        {{ count }} {{ what -}}(s); {{ when }}

## count
- platform: template
  sensors:
    motion_detected_entity_count_dogshedmiddle:
      friendly_name: dogshedmiddle found
      unit_of_measurement: entities
      entity_id:
        - binary_sensor.motion_detected_entity_dogshedmiddle
      value_template: >-
        {{ states('sensor.motion_annotated_entity_count_dogshedmiddle')|int }}

## counter
- platform: template
  sensors:
    motion_detected_entity_counter_dogshedmiddle:
      friendly_name: dogshedmiddle found counter
      entity_id:
        - sensor.motion_detected_entity_when_dogshedmiddle
      unit_of_measurement: count
      value_template: >
        {% if states('counter.motion_detected_entity_counter_dogshedmiddle') != 'unknown' %}
          {{ states('counter.motion_detected_entity_counter_dogshedmiddle')|int }}
        {%- else -%}null{%- endif -%}

## date
- platform: template
  sensors:
    motion_detected_entity_date_dogshedmiddle:
      entity_id:
        - sensor.motion_detected_entity_count_dogshedmiddle
      unit_of_measurement: seconds
      value_template: >-
        {% set date = states('sensor.motion_annotated_date_dogshedmiddle')|int %}
        {% if date > 0 %}{{ date }}{% else %}null{% endif %}

## when - human readable
- platform: template
  sensors:
    motion_detected_entity_when_dogshedmiddle:
      friendly_name: dogshedmiddle identified at
      entity_id:
        - sensor.motion_detected_entity_date_dogshedmiddle
      value_template: >-
        {% set date = states('sensor.motion_detected_entity_date_dogshedmiddle')|int %}
        {% if date > 0 %}{{ date|timestamp_custom("%a %b %d ~ %I:%M %p") }}{% else %}never{% endif %}

## ago
- platform: template
  sensors:
    motion_detected_entity_ago_dogshedmiddle:
      friendly_name: dogshedmiddle found ago
      entity_id:
        - sensor.motion_detected_entity_date_dogshedmiddle
        - sensor.time
      unit_of_measurement: seconds
      value_template: >
        {% set s = states('sensor.motion_detected_entity_date_dogshedmiddle')|int %}
        {% if s >  0 %}
          {% set s = now().timestamp()|int - s %}
          {% if s <  86400 %}{{ s }}{% else %}null{% endif %}
        {%- else -%}null{%- endif -%}

## percent
- platform: template
  sensors:
    motion_detected_entity_percent_dogshedmiddle:
      friendly_name: dogshedmiddle found
      entity_id:
        - sensor.motion_annotated_counter_dogshedmiddle
        - sensor.motion_detected_entity_counter_dogshedmiddle
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_entity_counter_dogshedmiddle')|int > 0 and states('sensor.motion_annotated_counter_dogshedmiddle')|int > 0 %}
          {{ states('sensor.motion_detected_entity_counter_dogshedmiddle')|int / states('sensor.motion_annotated_counter_dogshedmiddle')|int * 100.0 }}
        {%- else -%}null{%- endif -%}

###
# statistics
###

## count
- platform: template
  sensors:
    motion_detected_entity_count_mean_dogshedmiddle:
      friendly_name: dogshedmiddle found avg
      entity_id:
        - sensor.motion_detected_entity_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states('sensor.motion_detected_entity_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_count_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle found min
      entity_id:
        - sensor.motion_detected_entity_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states('sensor.motion_detected_entity_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_count_dogshedmiddle_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle found max
      entity_id:
        - sensor.motion_detected_entity_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states('sensor.motion_detected_entity_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_count_dogshedmiddle_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle found stdev
      entity_id:
        - sensor.motion_detected_entity_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states('sensor.motion_detected_entity_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_count_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_dogshedmiddle_change:
      friendly_name: dogshedmiddle found change
      entity_id:
        - sensor.motion_detected_entity_count_dogshedmiddle_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states('sensor.motion_detected_entity_count_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_count_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## counter
- platform: template
  sensors:
    motion_detected_entity_counter_dogshedmiddle_mean:
      friendly_name: dogshedmiddle found avg
      entity_id:
        - sensor.motion_detected_entity_counter_dogshedmiddle_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics|lower != 'none' %}
          {% if states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics.state|int is number %}
            {{ states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics.state|float }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle found min
      entity_id:
        - sensor.motion_detected_entity_counter_dogshedmiddle_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle found max
      entity_id:
        - sensor.motion_detected_entity_counter_dogshedmiddle_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle found stdev
      entity_id:
        - sensor.motion_detected_entity_counter_dogshedmiddle_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_dogshedmiddle_change:
      friendly_name: dogshedmiddle found change
      entity_id:
        - sensor.motion_detected_entity_counter_dogshedmiddle_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_counter_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_dogshedmiddle_stdev_change:
      friendly_name: dogshedmiddle found stdev change
      entity_id:
        - sensor.motion_detected_entity_counter_dogshedmiddle_stdev_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_detected_entity_counter_dogshedmiddle_stdev_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_counter_dogshedmiddle_stdev_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## ago
- platform: template
  sensors:
    motion_detected_entity_ago_dogshedmiddle_mean:
      friendly_name: dogshedmiddle found ago avg
      entity_id:
        - sensor.motion_detected_entity_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics|lower != 'none' %}
          {% if states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics.state|int is number %}
            {{ states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics.state|float }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle found ago min
      entity_id:
        - sensor.motion_detected_entity_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle found ago max
      entity_id:
        - sensor.motion_detected_entity_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle found ago stdev
      entity_id:
        - sensor.motion_detected_entity_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_dogshedmiddle_change:
      friendly_name: dogshedmiddle found ago change
      entity_id:
        - sensor.motion_detected_entity_ago_dogshedmiddle_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_ago_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_dogshedmiddle_stdev_change:
      friendly_name: dogshedmiddle found ago stdev change
      entity_id:
        - sensor.motion_detected_entity_ago_dogshedmiddle_stdev_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_ago_dogshedmiddle_stdev_statistics|lower != 'none' %}
          {{ states.sensor.motion_detected_entity_ago_dogshedmiddle_stdev_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## percent
- platform: template
  sensors:
    motion_detected_entity_percent_dogshedmiddle_mean:
      friendly_name: dogshedmiddle found avg
      entity_id:
        - sensor.motion_detected_entity_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_entity_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_percent_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle found min
      entity_id:
        - sensor.motion_detected_entity_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_entity_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_percent_dogshedmiddle_statistics.attributes.min_value|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle found max
      entity_id:
        - sensor.motion_detected_entity_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_entity_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_percent_dogshedmiddle_statistics.attributes.max_value|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle found stdev
      entity_id:
        - sensor.motion_detected_entity_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_detected_entity_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_percent_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_dogshedmiddle_change:
      friendly_name: dogshedmiddle found change
      entity_id:
        - sensor.motion_detected_entity_percent_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_detected_entity_percent_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_percent_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## statistics

# count
- platform: statistics
  name: motion_detected_entity_count_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_entity_count_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_entity_count_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_entity_count_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

# counter
- platform: statistics
  name: motion_detected_entity_counter_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_entity_counter_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_entity_counter_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_entity_counter_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

# ago
- platform: statistics
  name: motion_detected_entity_ago_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_entity_ago_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_entity_ago_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_entity_ago_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

# percent
- platform: statistics
  name: motion_detected_entity_percent_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_entity_percent_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_entity_percent_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_entity_percent_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

###
# snapshot
###

- platform: template
  sensors:
    motion_end_snapshot_dogshedmiddle:
      entity_id:
        - sensor.motion_end_counter_dogshedmiddle
      value_template: >-
        {% set bu = states('sensor.motion_base_url') %}
        {% if bu != 'unknown' %}
          {{ bu + '/local/images/motion_end-dogshedmiddle.jpg' }}
        {% else %}{{ states('sensor.motion_testsignal_picture') }}{% endif %}

- platform: template
  sensors:
    motion_annotated_snapshot_dogshedmiddle:
      entity_id:
        - sensor.motion_annotated_counter_dogshedmiddle
      value_template: >-
        {% set bu = states('sensor.motion_base_url') %}
        {% if bu != 'unknown' %}
          {{ bu + '/local/images/motion_annotated-dogshedmiddle.jpg' }}
        {% else %}{{ states('sensor.motion_testsignal_picture') }}{% endif %}

- platform: template
  sensors:
    motion_detected_snapshot_dogshedmiddle:
      entity_id:
        - sensor.motion_detected_counter_dogshedmiddle
      value_template: >-
        {% set bu = states('sensor.motion_base_url') %}
        {% if bu != 'unknown' %}
          {{ bu + '/local/images/motion_detected-dogshedmiddle.jpg' }}
        {% else %}{{ states('sensor.motion_testsignal_picture') }}{% endif %}

- platform: template
  sensors:
    motion_detected_entity_snapshot_dogshedmiddle:
      entity_id:
        - sensor.motion_detected_entity_counter_dogshedmiddle
      value_template: >-
        {% set bu = states('sensor.motion_base_url') %}
        {% if bu != 'unknown' %}
          {{ bu + '/local/images/motion_detected_entity-dogshedmiddle.jpg' }}
        {% else %}{{ states('sensor.motion_testsignal_picture') }}{% endif %}

###
## picture
###

- platform: template
  sensors:
    motion_end_picture_dogshedmiddle:
      entity_id:
        - sensor.motion_event_end_dogshedmiddle
        - camera.motion_event_end_dogshedmiddle
      value_template: >-
        {% set bu = states('sensor.motion_base_url') %}
        {% set ep = state_attr('camera.motion_event_end_dogshedmiddle','entity_picture') %}
        {% if ep is not none and ep != 'unknown' and ep != 'null' and bu != 'unknown' %}
          {% set p = bu + ep %}
        {% else %}
          {% set p = states('sensor.motion_testsignal_picture') %}
        {% endif %}
        {% if p is defined and p is not none and p != 'unknown' and p != 'null' %}
          {{ p }}
        {% else %}
           {{ states('sensor.motion_nosignal_picture') }}
        {% endif %}

- platform: template
  sensors:
    motion_annotated_picture_dogshedmiddle:
      entity_id:
        - sensor.motion_event_annotated_dogshedmiddle
        - camera.motion_event_annotated_dogshedmiddle
      value_template: >-
        {% set bu = states('sensor.motion_base_url') %}
        {% set ep = state_attr('camera.motion_event_annotated_dogshedmiddle','entity_picture') %}
        {% if ep is not none and ep != 'unknown' and ep != 'null' and bu != 'unknown' %}
          {% set p = bu + ep %}
        {% else %}
          {% set p = states('sensor.motion_testsignal_picture') %}
        {% endif %}
        {% if p is defined and p is not none and p != 'unknown' and p != 'null' %}
          {{ p }}
        {% else %}
           {{ states('sensor.motion_nosignal_picture') }}
        {% endif %}

- platform: template
  sensors:
    motion_detected_picture_dogshedmiddle:
      friendly_name: dogshedmiddle detected picture
      entity_id:
        - sensor.motion_annotated_picture_dogshedmiddle
        - sensor.motion_detected_counter_dogshedmiddle
      value_template: >-
        {% set n = states('sensor.motion_annotated_count_dogshedmiddle')|int %}
        {% if n > 0 %}
          {% set p = states('sensor.motion_annotated_picture_dogshedmiddle') %}
        {% else %}
          {% set p = states('sensor.motion_detected_picture_dogshedmiddle') %}
        {% endif %}
        {% if p is not none and p != 'unknown' and p != 'null' %}
          {{ p }}
        {% else %}
          {{ states('sensor.motion_nosignal_picture') }}
        {% endif %}

- platform: template
  sensors:
    motion_detected_entity_picture_dogshedmiddle:
      friendly_name: dogshedmiddle detected entity picture
      entity_id:
        - sensor.motion_detected_picture_dogshedmiddle
        - sensor.motion_detected_entity_counter_dogshedmiddle
      value_template: >-
        {% set n = states('sensor.motion_annotated_entity_count_dogshedmiddle')|int %}
        {% if n > 0 %}
          {% set p = states('sensor.motion_annotated_picture_dogshedmiddle') %}
        {% else %}
          {% set p = states('sensor.motion_detected_entity_picture_dogshedmiddle') %}
        {% endif %}
        {% if p is not none and p != 'unknown' and p != 'null' %}
          {{ p }}
        {% else %}
           {{ states('sensor.motion_nosignal_picture') }}
        {% endif %}

###
# complete
###

- platform: template
  sensors:
    motion_complete_dogshedmiddle:
      unit_of_measurement: seconds
      friendly_name: dogshedmiddle complete
      entity_id:
        - camera.motion_event_annotated_dogshedmiddle
        - sensor.motion_event_annotated_dogshedmiddle
      value_template: >
        {% set c = as_timestamp(states.camera.motion_event_annotated_dogshedmiddle.last_updated) %}
        {% set s = as_timestamp(states.sensor.motion_event_annotated_dogshedmiddle.last_updated) %}
        {{  c|float - s|float }}

# complete statistics
- platform: template
  sensors:
    motion_detected_entity_complete_dogshedmiddle_mean:
      friendly_name: dogshedmiddle complete avg
      entity_id:
        - sensor.motion_detected_entity_complete_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_entity_complete_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_complete_dogshedmiddle_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_complete_dogshedmiddle_min_value:
      friendly_name: dogshedmiddle complete min
      entity_id:
        - sensor.motion_detected_entity_complete_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_entity_complete_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_complete_dogshedmiddle_statistics.attributes.min_value|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_complete_dogshedmiddle_max_value:
      friendly_name: dogshedmiddle complete max
      entity_id:
        - sensor.motion_detected_entity_complete_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states('sensor.motion_detected_entity_complete_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_complete_dogshedmiddle_statistics.attributes.max_value|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_complete_dogshedmiddle_stdev:
      friendly_name: dogshedmiddle complete stdev
      entity_id:
        - sensor.motion_detected_entity_complete_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_detected_entity_complete_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_complete_dogshedmiddle_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_complete_dogshedmiddle_change:
      friendly_name: dogshedmiddle complete change
      entity_id:
        - sensor.motion_detected_entity_complete_dogshedmiddle_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states('sensor.motion_detected_entity_complete_dogshedmiddle_statistics') != 'unknown' %}
          {{ states.sensor.motion_detected_entity_complete_dogshedmiddle_statistics.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# statistics
- platform: statistics
  name: motion_detected_entity_complete_dogshedmiddle_statistics
  entity_id: sensor.motion_detected_entity_complete_dogshedmiddle
  sampling_size: 1000
  max_age:
    hours: 72
- platform: statistics
  name: motion_detected_entity_complete_dogshedmiddle_stdev_statistics
  entity_id: sensor.motion_detected_entity_complete_dogshedmiddle_stdev
  sampling_size: 1000
  max_age:
    hours: 72

###
### variable detection; produce array of booleans
###

- platform: template
  sensors:
    motion_detected_person_dogshedmiddle:
      entity_id:
        - binary_sensor.motion_detected_dogshedmiddle
        - sensor.motion_detected_ago_dogshedmiddle
      value_template: >-
        {% if states.sensor.motion_event_annotated_dogshedmiddle|lower != 'none'
              and state_attr('sensor.motion_event_annotated_dogshedmiddle','detected')|lower != 'none'
              and states.sensor.motion_event_annotated_dogshedmiddle.attributes.count|int > 0
              and state_attr('input_select.motion_detect_person','options')|lower != 'none' %}
          {% for detected in states.sensor.motion_event_annotated_dogshedmiddle.attributes.detected %}
            {%- if loop.first -%}[{%- else -%},{%- endif -%}
            {% if detected.entity in state_attr('input_select.motion_detect_person','options') %}{{ detected.count }}{% else %}0{% endif %}
            {%- if loop.last -%}]{%- endif -%}
          {% endfor %}
        {% else %}null{% endif %}

- platform: template
  sensors:
    motion_detected_vehicle_dogshedmiddle:
      entity_id:
        - binary_sensor.motion_detected_dogshedmiddle
        - sensor.motion_detected_ago_dogshedmiddle
      value_template: >-
        {% if states.sensor.motion_event_annotated_dogshedmiddle|lower != 'none'
              and state_attr('sensor.motion_event_annotated_dogshedmiddle','detected')|lower != 'none'
              and states.sensor.motion_event_annotated_dogshedmiddle.attributes.count|int > 0
              and state_attr('input_select.motion_detect_vehicle','options')|lower != 'none' %}
          {% for detected in states.sensor.motion_event_annotated_dogshedmiddle.attributes.detected %}
            {%- if loop.first -%}[{%- else -%},{%- endif -%}
            {% if detected.entity in state_attr('input_select.motion_detect_vehicle','options') %}{{ detected.count }}{% else %}0{% endif %}
            {%- if loop.last -%}]{%- endif -%}
          {% endfor %}
        {% else %}null{% endif %}

- platform: template
  sensors:
    motion_detected_animal_dogshedmiddle:
      entity_id:
        - binary_sensor.motion_detected_dogshedmiddle
        - sensor.motion_detected_ago_dogshedmiddle
      value_template: >-
        {% if states.sensor.motion_event_annotated_dogshedmiddle|lower != 'none'
              and state_attr('sensor.motion_event_annotated_dogshedmiddle','detected')|lower != 'none'
              and states.sensor.motion_event_annotated_dogshedmiddle.attributes.count|int > 0
              and state_attr('input_select.motion_detect_animal','options')|lower != 'none' %}
          {% for detected in states.sensor.motion_event_annotated_dogshedmiddle.attributes.detected %}
            {%- if loop.first -%}[{%- else -%},{%- endif -%}
            {% if detected.entity in state_attr('input_select.motion_detect_animal','options') %}{{ detected.count }}{% else %}0{% endif %}
            {%- if loop.last -%}]{%- endif -%}
          {% endfor %}
        {% else %}null{% endif %}
